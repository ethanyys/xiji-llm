# 电商KBQA系统实战

KBQA（Knowledge Base Question Answering）作为一种底层基于知识图谱的问答技术，可以利用高度标准化的数据进行推理问答。
在现阶段，基于特定领域知识图谱的简单问答效果已经达到了一个比较好的水平。

## 技术选型
结合问句分析的结果，从技术路线上主要可以分为基于检索排序的问答策略和基于语法解析的问答两种。
基于语法解析的方案依赖高精度的Parsing能力，并要求对数据逻辑、图谱实体、关系等有深入了解，上手门槛高。
我们这个实践项目选择检索排序的方案来实现KBQA系统，整理流程如下：

1. 对用户输入进行结构化分析，识别出其中的核心词。例如：「苹果手机的型号有哪些？」
通过NER算法识别后得到核心实体「苹果：品牌」、「手机：产品」
2. 以上一步得到的实体为核心，圈选候选知识SOP集合。
要做到这一步首先需要对电商知识图谱进行预处理，将KG中的结构化知识转写成SOP，
一般是以核心词的一跳属性来扩展，详见下文知识构建章节
3. 将Query同样进行编码，计算Query和SOP知识的向量距离作为相关性打分的判断依据。
这里我们选择预训练的语义向量化模型来做文本的编码，并使用向量数据库进行相关性检索

在这个过程中，大家可以上手实践的内容包括：中文NER模型的构建、知识图谱的构建使用、语义召回和排序等。
既包含了算法训练和部署，也有数据处理和使用的演练过程。

## 中文NER系统
基于bert-chinese-base训练中文NER模型，模型需要先去下载：Huggingface和Modelscope都可以
### 核心代码
```angular2html
project1
|- model 
    |- bert.py          Bert模型的核心类，包含模型训练、评测、预测方法
    |- dataset.py       数据加载和结构化类
    |- metric.py        NER任务评估方法
    |- train.py         模型训练PipeLine，包含数据加载、预处理，模型训练和保存
```


## 知识构建


## 向量检索